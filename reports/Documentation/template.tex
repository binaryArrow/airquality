\documentclass[]{article}
\usepackage[german]{babel}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage[backend=bibtex, natbib=true]{biblatex}
\usepackage{listings}
\usepackage{tikz}

\lstset{%
	basicstyle=\ttfamily\scriptsize,        % Code font, Examples: \footnotesize, \ttfamily
	keywordstyle=\color{blue!80!black},     % Keywords font ('*' = uppercase)
	commentstyle=\color{gray},              % Comments font
	numbers=left,                           % Line nums position
	numberstyle=\tiny,                      % Line-numbers fonts
	stepnumber=1,                           % Step between two line-numbers
	numbersep=5pt,                          % How far are line-numbers from code
	backgroundcolor=\color{gray!10!white},  % Choose background color
	frame=none,                             % A frame around the code
	tabsize=2,                              % Default tab size
	captionpos=b,                           % Caption-position = bottom
	breaklines=true,                        % Automatic line breaking?
	breakatwhitespace=false,                % Automatic breaks only at whitespace?
	showspaces=false,                       % Dont make spaces visible
	showstringspaces=false                  %
	showtabs=false,                         % Dont make tabls visible
	columns=flexible,                       % Column format
	morekeywords={},                        % Specific keywords
	stringstyle=\color{green!50!black},%
}%

\bibliography{bibliography}
%opening
%Here you can enter your names and titleof your report
\title{Dokumentation - Luftqualität in Innenräumen - Gruppe 1}
\author{Friedrich Just 1326699 \\ Stipe Knez 1269206 \\ Lucas Merkert 1326709 \\ Achim Glaesmann 1309221 \\ Max-Rene Konieczka 1211092 \\ Can Cihan Nazlier 1179244}

\begin{document}

	\begin{titlepage}
		\maketitle
		\thispagestyle{empty}
	\end{titlepage}
	\tableofcontents
	\setcounter{page}{1}
	\newpage
	
	
	\section{Projektthema}
	Die durch Covid-19 verursachte Pandemie prägte die letzten 2 Jahre fast der gesamten Welt. Insgesamt forderte die Krankheit etwa 5,18 Millionen Menschenleben. Dennoch ist das Thema aktueller denn je. Europaweit steigen die Infektionszahlen auf nie dagewesene Werte, während die im Sommer verabreichten Impfungen langsam an Effektivität verlieren. Ein Hauptrisiko zur Infektion besteht dabei in Innenräumen. Unser Auftrag besteht nun darin, ein System zu entwickeln welches in der Lage ist, das Infektionsrisiko einzelner Räume eines Gebäudes einzuschätzen und so einen Richtwert für den Anwender darstellt, wie er sein Verhalten diesem Wert anpassen kann. Realisiert werden soll dieses System über die Verwendung verschiedener Sensoren zur Erfassung mit dem Infektionsrisiko direkt verknüpfter physikalischer Größen. Die zur Ansteckung, vermutlich, wichtigen Aerosole, können dabei nur bedingt durch Masken zurückgehalten werden, es macht also Sinn abzuschätzen inwieweit die Luft eines Raumes durch Aerosole belastet ist. Da die direkte Messung von Aerosolen zeitaufwendig und schwer umsetzbar ist, konzentrieren wir uns hierbei auf Werte, die einen direkten Rückschluss auf die Ausatemmenge der Personen im Raum ermöglichen. Mit der Annahme, dass die Aerosolkonzentration dabei direkt abhängig zur Ausatemmenge ist.\newline
	Um dies zu erreichen, bedienen wir uns folgender Sensoren: Dem CCS811 von Adafruit, dem SCD41 und dem SHT21 von Sensirion. Der CCS881 ist ein energieeffizienter digitaler Gassensor, welcher über die Verwendung eines Metalloxidsensors ein breites Spektrum an flüchtigen organischen Verbindungen messen kann. Diese gibt der Sensor als CO2-Äquivalente an. Der CO2-Äquivalenzbereich geht hierbei von 400ppm bis 8192ppm. Eine Kompensation für Abweichungen durch Temperatur und Luftfeuchtigkeit ist dabei über einen externen Feuchtigkeits- und Temperatursensor möglich. Dies ermöglicht in Verbindung mit einem Mikrokontroller die Überwachung der Luftqualität. Der Sensor enthält dabei eine I²C-Schnittstelle sowie einen Analog-Digital-Converter.
	Der SHT21 ermöglicht die Messung der relativen Luftfeuchtigkeit so wie der Temperatur mit einer Genauigkeit von ±2\% relativer Luftfeuchtigkeit so wie ±0.3° Celsius bezüglich der Temperatur.\newline
	Beim SCD41 Sensor handelt es sich um einen miniaturisierten CO2-Sensor basierend auf dem photoakustischem Sensorprinzip. Dabei wird über einen im Sensor integrierten SHT41 Feuchtigkeits- und Temperatursensor eine chipinterne Signalkompensierung ermöglicht. Die Genauigkeit des SCD41 beträgt dabei im Bereich von 400 ppm – 5’000 ppm ± (40 ppm + 5\% des abgelesenen Wertes). Beide Sensoren von Sensirion können über die I²C-Schnittstelle angesprochen werden. Genauere Informationen zu den Sensoren sind im Unterkapitel Sensoren vermerkt.\newline
	Die so ermittelten Daten sollen anschließend in eine graphische Darstellung in Form einer Ampelindikation überführt werden, um dem Anwender eine direkte Bewertung der Gefahrenlage zu ermöglichen. Die Kommunikation zwischen Mikrocontroller und Sensoren soll dabei via I²C-Schnittstelle erfolgen, die Kommunikation zwischen den einzelnen Mikrokontrollern auf Basis des ZigBee-Protokolls. Um dies zu ermöglichen wurde entschieden, einen Microcontroller auf Basis des Atmega256rfr2-Chips zu verwenden, welcher die Verwendung beider Übertragungsprotokolle ermöglicht, so wie eine serielle Kommunikation über eine UART-Bridge. Die ermittelten Daten werden wie erwähnt seriell an eine von uns entwickelte Applikation auf einem leistungsfähigeren Endgerät übermittelt, welches die Daten auswertet und in ein graphisches Modell des zu beschreibenden Zimmers einbettet. Das Frontend der Applikation soll dabei mittels JavaScript realisiert werden, während das Backend in Java zu verwirklichen ist. Die Applikation soll es dem Anwender grundsätzlich ermöglichen eigene Grundrisse zu zeichnen, Räume zu definieren und Sensoren in diesen zu platzieren. Die ermittelten Werte der Sensoren sollen dabei einmal innerhalb von Graphen zeitlich dargestellt werden sowie die über einen eigens zu entwickelnden Algorithmus errechnete Gefahrenlage mittels eines Ampelsystems einmal innerhalb der Anwendung als auch über eine am jeweiligen Funkmodul angebrachte LED dargestellt werden. 
	
	\section{Aufgabenaufteilung} %kurze aufgabenteilung
	Zu Beginn des Projektes wurde entschieden die Aufgaben in zwei Teile zu spalten, einerseits in einen Sensorteil und andererseits in einen Applikationsteil. Es wurde festgelegt, dass Herr Merkert, Herr Just und Herr Glaesmann sich um die Einrichtung und Programmierung der Sensoren kümmern, während Herr Knez, Herr Nazlier und Herr Konieczka sich um die Einrichtung eines Servers und die Entwicklung der Applikation kümmern. 
		\subsection{Friedrich Just}
		\subsection{Stipe Knez}
		\subsection{Lucas Merkert}
		\subsection{Achim Glaesmann}
		\subsection{Max-Rene Konieczka}
		\subsection{Can Cihan Nazlier}
		
	\section{Ergebnisse der Recherche}%Lucas/Achim Friedrich
	\section{Lösungsansatz} %detaillierte beschreibung der einzelnen Aufgaben, probleme und Lösungen
		%TODO different subsections wer was wie gelöst hat und welche Probleme aufgetreten sind, dabei angeben welche Standards/werkzeuge/equipment genutzt worden sind
		
	\section{Ausblick und Erweiterungsmöglichkeiten}
		
		
	\section{Zustandsdiagramm}
	\tikzstyle{block} = [rectangle, draw, fill=white!20, text width=20em, text centered, rounded corners, minimum height=4em]
	\tikzstyle{line} = [draw, Latex,length=3mm, width=2mm]
	\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=5cm, minimum height=5em]
	
	\begin{tikzpicture}[node distance = 2cm, auto]
		% Place nodes
		\node [block, align= center] (start) {APP\_STARTUP\_STATE \\ appInitUsartManager \\initTimer};
		\node [block, below of=start] (startnetwork) {APP\_STARTJOIN\_NETWORK \\ ZDO\_StartNetworkReq};
		\node [block, below of=startnetwork] (initendpoint) {APP\_INIT\_ENDPOINT \\ initEndpoint};
		\node [block, below of=initendpoint] (inittransmit) {APP\_INIT\_TRANSMITDATA \\ initTransmitData};
		\node [block, below of=inittransmit] (appresetccsswstate) {APP\_RESET\_CCS\_SW\_STATE \\ I2C-Write: 0xFF 0x11 0xE5 0x72 0x8A \\ SW\_RESET\_REG \\ SW\_RESET\_SEQUENCE};
		\node [block, below of=appresetccsswstate] (appccshwidwriteregstate) {APP\_CCS\_HW\_ID\_WRITE\_REG\_STATE \\ I2C-Write: 0x20 \\ HW\_ID\_REG};
		\node [block, below of=appccshwidwriteregstate] (appccshwidreadstate) {APP\_CCS\_HW\_ID\_READ\_STATE \\ I2C-Read: 1 byte \\ Hardware ID has to be 0x81};
		\node [block, below of=appccshwidreadstate] (appccschangetoappstatestate) {APP\_CCS\_CHANGE\_TO\_APPSTATE\_STATE \\ I2C-Write: 0xF4 \\ BOOTLOADER\_APP\_START};
		\node [block, below of=appccschangetoappstatestate] (appccswritemeasregstate) {APP\_CCS\_WRITE\_MEAS\_REG\_STATE \\ I2C-Write: 0x01 0xTODO \\ MEAS\_MODE\_REG \\ (Measure every TODO)};
		\node [block, below of=appccswritemeasregstate] (appccswritestatusregstate) {APP\_CCS\_WRITE\_STATUS\_REG\_STATE \\ I2C-Write: 0x00\\STATUS\_REG};
		\node [block, below of=appccswritestatusregstate] (appccsreadstatusregstate) {APP\_CCS\_READ\_STATUS\_REG\_STATE \\ I2C-Read: 1 byte\\ Bit 0: error \\ Bit 3: data ready};
		\node [block, below of=appccsreadstatusregstate] (appresetscdstate) {APP\_RESET\_SCD\_STATE \\ I2C-Write: 0x3F 0x86\\ TODO ask Achim};
		\node [block, right of=appresetscdstate, node distance=8cm] (appinitsensorstate) {APP\_INIT\_SENSOR\_STATE \\ I2C-Write: 0x21 0xB1\\ TODO ask Achim \\ HAL\_StartAppTimer(30 s)};
		\node [block, above of=appinitsensorstate] (appcallforreadscdstate) {APP\_CALL\_FOR\_READ\_SCD\_STATE \\ I2C-Write:TODO\\ TODO ask Achim};
		\node [block, above of=appcallforreadscdstate] (appreadscdstate) {APP\_READ\_SCD\_STATE \\ I2C-Read: 9 bytes\\ TODO ask Achim};
		\node [block, above of=appreadscdstate] (appcallforreadtempshtstate) {APP\_CALL\_FOR\_READ\_TEMP\_SHT\_STATE\\ I2C-Write: TODO\\ TODO ask Achim};
		\node [block, above of=appcallforreadtempshtstate] (appreadtempshtstate) {APP\_READ\_TEMP\_SHT\_STATE\\ I2C-Read: 2 bytes\\ TODO ask Achim};
		\node [block, above of=appreadtempshtstate] (appcallforreadrhshtstate) {APP\_CALL\_FOR\_READ\_RH\_SHT\_STATE\\ I2C-Write: TODO\\ TODO ask Achim};
		\node [block, above of=appcallforreadrhshtstate] (appreadrhshtstate) {APP\_READ\_RH\_SHT\_STATE\\ I2C-Read: 2 bytes\\ TODO ask Achim};
		\node [block, above of=appreadrhshtstate] (appccswriteresultregstate) {APP\_CCS\_WRITE\_RESULT\_REG\_STATE\\ I2C-Write: 0x02\\ ALG\_RESULT\_DATA\_REG};
		\node [block, above of=appccswriteresultregstate] (appccsreadresultregstate) {APP\_CCS\_READ\_RESULT\_REG\_STATE\\ I2C-Read: 4 bytes (eCO2 | TVOC)};
		\node [block, above of=appccsreadresultregstate] (appausgabestate) {APP\_AUSGABE\_STATE\\ calculating outpout of SCD,SHT,CCS};
		\node [block, above of=appausgabestate] (transmit) {APP\_TRANSMIT \\ encode Message \\ send Message};
		
		
		%\node [block, right of=initendpoint, node distance=8cm] (resetCCS) {APP_RESET_CCS_SW_STATE};
		
		% Draw edges
		\draw [-latex, line width=2pt] (start) -- (startnetwork);
		\draw [-latex, line width=2pt] (startnetwork) -- (initendpoint);
		\draw [-latex, line width=2pt] (initendpoint) -- (inittransmit);
		\draw [-latex, line width=2pt] (inittransmit) -- (appresetccsswstate);
		\draw [-latex, line width=2pt] (appresetccsswstate) -- (appccshwidwriteregstate);
		\draw [-latex, line width=2pt] (appccshwidwriteregstate) -- (appccshwidreadstate);
		\draw [-latex, line width=2pt] (appccshwidreadstate) -- (appccschangetoappstatestate);
		\draw [-latex, line width=2pt] (appccschangetoappstatestate) -- (appccswritemeasregstate);
		\draw [-latex, line width=2pt] (appccswritemeasregstate) -- (appccswritestatusregstate);
		\draw [-latex, line width=2pt] (appccswritestatusregstate) -- (appccsreadstatusregstate);
		\draw [-latex, line width=2pt] (appccsreadstatusregstate) -- (appresetscdstate);
		\draw [-latex, line width=2pt] (appresetscdstate) -- (appinitsensorstate);
		\draw [-latex, line width=2pt] (appinitsensorstate) -- (appcallforreadscdstate);
		\draw [-latex, line width=2pt] (appcallforreadscdstate) -- (appreadscdstate);
		\draw [-latex, line width=2pt] (appreadscdstate) -- (appcallforreadtempshtstate);
		\draw [-latex, line width=2pt] (appcallforreadtempshtstate) -- (appreadtempshtstate);
		\draw [-latex, line width=2pt] (appreadtempshtstate) -- (appcallforreadrhshtstate);
		\draw [-latex, line width=2pt] (appcallforreadrhshtstate) -- (appccswriteresultregstate);
		\draw [-latex, line width=2pt] (appccswriteresultregstate) -- (appccsreadresultregstate);
		\draw [-latex, line width=2pt] (appccsreadresultregstate) -- (appausgabestate);
		\draw [-latex, line width=2pt] (appausgabestate) -- (transmit);
		\draw [-latex, line width=2pt] (transmit) -- (appinitsensorstate);
	
	
	\end{tikzpicture}
%----------------------------------------------------------------------------
% Bibliography
%----------------------------------------------------------------------------	
\printbibliography
\end{document}
